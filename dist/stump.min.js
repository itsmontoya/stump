export function stump(t){const e=document.getElementById(t.targetID);e.innerHTML="";let n=Object.assign({},t.state);function o(r){n=r(n),!0===t.debug&&console.log("State update",n),update(o,e,t.view(n),e.children[0])}update(o,e,t.view(t.state),void 0,0),t.dispatchers.forEach(t=>t(o))}export const c=t=>({type:t.type,children:t.children||[],options:t.options||{}});export const response=t=>e=>e(t);export const action=t=>(e,n)=>n(n=>t(e,n));export const children=(...t)=>{const e=new Children;return t&&t.forEach(t=>e.append(t)),e};function create(t,e){if("string"==typeof e)return document.createTextNode(e);const n=document.createElement(e.type);return function(t,e,n){if(!n)return;n.map(e=>create(t,e)).forEach(e.appendChild.bind(e))}(t,n,e.children),setOptions(t,n,e.options),n}function update(t,e,n,o,r=0){if(o)if(n)if(function(t,e){if("string"==typeof t)return function(t,e){return t!==e.nodeValue}(t,e);if(function(t,e){return typeof t!=typeof e}(t,e))return!0;if(function(t,e){return t.type!==function(t){if(!t)return"";const e=t=t;if(!e.tagName)return"";return e.tagName.toLowerCase()}(e)}(t,e))return!0;return!1}(n,o)){const o=create(t,n);e.replaceChild(o,getChildNode(e,r))}else!function(t,e,n){if("string"==typeof e)return;const o=e.children.length,r=n.childNodes.length;o>r?function(t,e,n,o){for(let r=0;r<o;r++)updateChild(t,e,n,r)}(t,e,n,o):function(t,e,n,o){for(let r=o-1;r>-1;r--)updateChild(t,e,n,r)}(t,e,n,r)}(t,n,o),function(t,e,n){if("string"==typeof e)return;const o=e;(function(t,e){for(let n=0;n<t.attributes.length;n++)clearAttribute(t,e,n);!function(t,e){if(!t.value)return;e.value||(t.value="")}(t,e)})(n,o.options),function(t){const e=t;if(!e.__stumpFns)return;for(;e.__stumpFns.length;){let t=e.__stumpFns.pop();e[t]=void 0}}(n),setOptions(t,n,o.options)}(t,n,o);else e.removeChild(getChildNode(e,r));else{const o=create(t,n);e.appendChild(o)}}function updateChild(t,e,n,o){var r,i;update(t,n,(i=o,(r=e).children?r.children[i]:void 0),getChildNode(n,o),o)}function setOptions(t,e,n){for(let o in n)setOption(t,e,n,o)}function setOption(t,e,n,o){const r=function(t){switch(t){case"contenteditable":return"contentEditable";default:return t}}(o),i=function(t,e,n){const o=e[n];if("style"===n)return function(t){var e=[];for(let n in t)e.push(`${n}: ${t[n]};`);return e.join(" ")}(o);if(isEventKey(n)){return((t,e)=>n=>e(n,t))(t,o)}return o}(t,n,o);isEventKey(o)?function(t,e,n){const o=t;o[e]=n,void 0===o.__stumpFns&&(o.__stumpFns=[]);o.__stumpFns.push(e)}(e,o,i):e.setAttribute(r,i)}function getChildNode(t,e){return t.childNodes[e]}function isEventKey(t){return"on"===t.substr(0,2)}function clearAttribute(t,e,n){const o=t.attributes[n].name;e[o]||t.removeAttribute(o)}const Children=function(){};Children.prototype.push=Array.prototype.push,Children.prototype.map=Array.prototype.map,Children.prototype.length=Array.prototype.length,Children.prototype.append=function(t){return null!=t&&this.push(t),this};